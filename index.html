<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Calculator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Multi-Calculator</h1>
        
        <!-- BMI Calculator -->
        <div class="calculator">
            <h2>BMI Calculator</h2>
            <form id="bmiForm">
                <div>
                    <label for="height">Height:</label>
                    <input type="number" id="height" name="height" required>
                    <select id="heightUnit">
                        <option value="cm">cm</option>
                        <option value="inches">inches</option>
                    </select>
                </div>
                <div>
                    <label for="weight">Weight:</label>
                    <input type="number" id="weight" name="weight" required>
                    <select id="weightUnit">
                        <option value="kg">kg</option>
                        <option value="lbs">lbs</option>
                    </select>
                </div>
                <button type="submit">Calculate BMI</button>
            </form>
            <div class="results" id="results">
                <!-- Results will be displayed here -->
            </div>
            <div id="bmiScale">
                <div class="scale">
                    <div class="marker" id="bmiMarker"></div>
                </div>
                <div class="scale-labels">
                    <span>10</span>
                    <span>15</span>
                    <span>20</span>
                    <span>25</span>
                    <span>30</span>
                    <span>35</span>
                    <span>40</span>
                    <span>45</span>
                </div>
            </div>
        </div>
        
        <!-- Weight Converter -->
        <div class="calculator">
            <h2>Weight Converter</h2>
            <form id="kgLbsForm">
                <div>
                    <label for="weightInput">Enter Weight:</label>
                    <input type="number" id="weightInput" name="weightInput" required>
                    <select id="weightUnitSelect">
                        <option value="kg">KG</option>
                        <option value="lbs">LBS</option>
                    </select>
                </div>
                <button type="submit">Convert</button>
            </form>
            <div id="kgLbsResults">
                <p>Converted: <span id="kgLbsValue"></span></p>
            </div>
        </div>
        
        <!-- Length Converter -->
        <div class="calculator">
            <h2>Length Converter</h2>
            <form id="metricImperialForm">
                <div id="lengthInputContainer">
                    <label for="lengthInput">Enter Length:</label>
                    <input type="number" id="lengthInput" name="lengthInput" required>
                </div>
                <div id="feetInchesInputs" style="display: none;">
                    <div>
                        <label for="feet">Feet:</label>
                        <input type="number" id="feet" name="feet">
                    </div>
                    <div>
                        <label for="inches">Inches:</label>
                        <input type="number" id="inches" name="inches">
                    </div>
                </div>
                <div>
                    <label for="lengthUnitSelect">Select Unit:</label>
                    <select id="lengthUnitSelect">
                        <option value="cm">CM</option>
                        <option value="feetInches">Feet/Inches</option>
                    </select>
                </div>
                <button type="submit">Convert</button>
            </form>
            <div id="metricImperialResults">
                <p>Converted: <span id="metricImperialValue"></span></p>
            </div>
        </div>

        <!-- About BMI Link -->
        <nav>
            <ul>
                <li><a href="about-bmi.html">About BMI</a></li>
            </ul>
        </nav>
        
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // BMI Calculator
            const bmiForm = document.getElementById('bmiForm');
            if (bmiForm) {
                bmiForm.addEventListener('submit', function(event) {
                    event.preventDefault();
        
                    // Get input values
                    const height = parseFloat(document.getElementById('height').value);
                    const weight = parseFloat(document.getElementById('weight').value);
                    const heightUnit = document.getElementById('heightUnit').value;
                    const weightUnit = document.getElementById('weightUnit').value;
        
                    // Convert units if necessary
                    let heightInMeters = height;
                    let weightInKg = weight;
        
                    if (heightUnit === 'inches') {
                        heightInMeters = height * 0.0254;
                    } else {
                        heightInMeters = height / 100;
                    }
        
                    if (weightUnit === 'lbs') {
                        weightInKg = weight * 0.453592;
                    }
        
                    // Calculate BMI
                    const bmi = weightInKg / (heightInMeters * heightInMeters);
        
                    // Determine BMI category for male and female
                    const categoryMale = getBMICategory(bmi, 'male');
                    const categoryFemale = getBMICategory(bmi, 'female');
        
                    // Display results
                    const resultsDiv = document.getElementById('results');
                    resultsDiv.innerHTML = `
                        <table>
                            <tr>
                                <th></th>
                                <th>Male</th>
                                <th>Female</th>
                            </tr>
                            <tr>
                                <td>BMI Score</td>
                                <td>${bmi.toFixed(2)}</td>
                                <td>${bmi.toFixed(2)}</td>
                            </tr>
                            <tr>
                                <td>BMI Category</td>
                                <td>${categoryMale}</td>
                                <td>${categoryFemale}</td>
                            </tr>
                        </table>
                    `;
        
                    // Update BMI marker position
                    const bmiMarker = document.getElementById('bmiMarker');
                    const scaleWidth = document.querySelector('.scale').offsetWidth;
                    const markerPosition = Math.min((bmi - 10) / 35 * scaleWidth, scaleWidth - 5); // Adjust marker position based on new scale
                    bmiMarker.style.left = `${markerPosition}px`;
                });
            }
        
            // KG and LBS Converter
            const kgLbsForm = document.getElementById('kgLbsForm');
            if (kgLbsForm) {
                kgLbsForm.addEventListener('submit', function(event) {
                    event.preventDefault();
        
                    // Get input values
                    const weightInput = parseFloat(document.getElementById('weightInput').value);
                    const weightUnit = document.getElementById('weightUnitSelect').value;
        
                    // Convert based on selected unit
                    let convertedValue = '';
                    if (weightUnit === 'kg') {
                        convertedValue = (weightInput * 2.20462).toFixed(2) + ' lbs';
                    } else if (weightUnit === 'lbs') {
                        convertedValue = (weightInput * 0.453592).toFixed(2) + ' kg';
                    } else {
                        convertedValue = 'Please enter a value to convert.';
                    }
        
                    // Display results
                    document.getElementById('kgLbsValue').textContent = convertedValue;
        
                    // Send conversion data to the backend
                    sendConversionData('Weight', `${weightInput} ${weightUnit}`, convertedValue);
                });
            }
        
            // Metric and Imperial Converter
            const metricImperialForm = document.getElementById('metricImperialForm');
            const lengthUnitSelect = document.getElementById('lengthUnitSelect');
            const feetInchesInputs = document.getElementById('feetInchesInputs');
            const lengthInputContainer = document.getElementById('lengthInputContainer');
            const lengthInput = document.getElementById('lengthInput');
            const feetInput = document.getElementById('feet');
            const inchesInput = document.getElementById('inches');
            
            if (metricImperialForm) {
                lengthUnitSelect.addEventListener('change', function() {
                    if (lengthUnitSelect.value === 'feetInches') {
                        lengthInputContainer.style.display = 'none';
                        feetInchesInputs.style.display = 'block';
                    } else {
                        lengthInputContainer.style.display = 'block';
                        feetInchesInputs.style.display = 'none';
                    }
                });
        
                metricImperialForm.addEventListener('submit', function(event) {
                    event.preventDefault();
        
                    let convertedValue = '';
                    if (lengthUnitSelect.value === 'cm') {
                        const lengthCm = parseFloat(lengthInput.value);
                        if (isNaN(lengthCm)) {
                            convertedValue = 'Please enter a valid number';
                        } else {
                            const totalInches = lengthCm * 0.393701;
                            const feetValue = Math.floor(totalInches / 12);
                            const inchesValue = (totalInches % 12).toFixed(2);
                            convertedValue = `${feetValue} ft ${inchesValue} in`;
                        }
                    } else if (lengthUnitSelect.value === 'feetInches') {
                        const feet = parseFloat(feetInput.value);
                        const inches = parseFloat(inchesInput.value);
                        if (isNaN(feet) || isNaN(inches)) {
                            convertedValue = 'Please enter valid numbers for feet and inches';
                        } else {
                            const totalCm = ((feet * 12) + inches) * 2.54;
                            convertedValue = `${totalCm.toFixed(2)} cm`;
                        }
                    } else {
                        convertedValue = 'Please enter a value to convert.';
                    }
        
                    // Display results
                    document.getElementById('metricImperialValue').textContent = convertedValue;
        
                    // Send conversion data to the backend
                    sendConversionData('Length', `${lengthInput} ${lengthUnit}`, convertedValue);
                });
            }
        
            // Function to get BMI category
            function getBMICategory(bmi, gender) {
                let category;
                if (bmi < 18.5) {
                    category = 'Underweight';
                } else if (bmi >= 18.5 && bmi <= 24.9) {
                    category = 'Healthy weight';
                } else if (bmi >= 25 && bmi <= 29.9) {
                    category = 'Overweight but not obese';
                } else if (bmi >= 30 && bmi <= 34.9) {
                    category = 'Obese class I';
                } else if (bmi >= 35 && bmi <= 39.9) {
                    category = 'Obese class II';
                } else {
                    category = 'Obese class III';
                }
        
                return category;
            }
        
            // Function to send conversion data to the backend
            async function sendConversionData(type, input, output) {
                const response = await fetch('http://localhost:5000/api/conversions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ type, input, output }),
                });
                const data = await response.json();
                console.log(data);
            }
        });
    </script>
</body>
</html>